REM  eZ publish document conversion macros

Sub convertToOOo(strFile as string) 
    Dim oDoc as Object 
    Dim strFilterSubName as String 
     
    strUrl = ConvertToUrl( strFile ) 
    oDoc = StarDesktop.loadComponentFromURL( strUrl, "_blank", 0, array(MakePropertyValue("Hidden",true))) 
     
    oDoc.storeToUrl( ConvertToUrl( "/tmp/ooo_converted.odt" ), Array()) 
     
    oDoc.close(True) 
End Sub 

Sub convertToPDF(strFile as string) 
    Dim oDoc as Object 
    Dim strFilterSubName as String 
     
    strUrl = ConvertToUrl( strFile ) 
    oDoc = StarDesktop.loadComponentFromURL( strUrl, "_blank", 0, array(MakePropertyValue("Hidden",true))) 
     
    cURL = ConvertToURL( "/tmp/ooo_converted.pdf" ) 
         
    oDoc.storeToURL( cURL, Array( MakePropertyValue( "FilterName", "writer_pdf_Export" ) ) 
     
    oDoc.close(True) 
End Sub 
 
Sub convertToDoc(strFile as string)
    Dim oDoc as Object 
    Dim strFilterSubName as String 
     
    strUrl = ConvertToUrl( strFile )
    oDoc = StarDesktop.loadComponentFromURL( strUrl, "_blank", 0, array(MakePropertyValue("Hidden",true)))
     
    cURL = ConvertToURL( "/tmp/ooo_converted.doc" )
         
    oDoc.storeToURL( cURL, Array( MakePropertyValue( "FilterName", "MS Word 97" ) )
     
    oDoc.close(True)
End Sub
 
Function MakePropertyValue( Optional cName As String, Optional uValue ) As com.sun.star.beans.PropertyValue 
    oPropertyValue = createUnoStruct( "com.sun.star.beans.PropertyValue" ) 
    If Not IsMissing( cName ) Then 
       oPropertyValue.Name = cName 
    EndIf 
    If Not IsMissing( uValue ) Then 
       oPropertyValue.Value = uValue 
    EndIf 
    MakePropertyValue() = oPropertyValue 
End Function
